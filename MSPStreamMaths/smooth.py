import matplotlib.pyplot as plt
import sys
from StreamClass import StreamMathsClass
ddt={'x': [0.17797827510222344, -0.06158566046586702, 0.2010912246580048, -0.027963631431991744, -0.05034727580293753, 0.09086824663747317, -0.5355616672053599, 0.1894517750354584, 0.051923602935944856, -0.3720459014747668, -0.9703813290003396, -0.13130276927470208, -0.17740702688686882, -0.1259156611721446, -0.832717319381496, 0.22931635816487939, 0.28007685840839625, -0.6471716023779228, 2.464274786381336, -1.0969233413119632, -1.1569701290861283, -0.9345417875985346, -0.1442375872036683, -0.17912001737386662, -0.25018636239306835, -0.5370616573576692, -0.01897506439259733, 0.05359764569155323, -0.5887263996065273, -0.056487744246310756, -0.37975893486484, -0.08154469379372475, -0.10657465267124744, -0.00783061769512261, -0.09145729955623239, -0.17354819781808195, 0.0884835129879713, -0.175674538499333, -0.15417682773126606, -0.04136280922949265, -0.11257286248714471, -0.06984110008467548, 0.12199968064756872, 0.17653316285105025, 0.19567283553440284, 0.09055517333895202, -0.2499914612066989, 0.09705920314645011, -0.15846237920996487, -0.2733165872247145, 0.1273627494347629, 1.970935964274319, 2.1088511626122504, 2.029549316612812, 1.3148039282064645, 1.535732211649375, 1.8112725624588404, 1.3739422166704007, 1.2900133643391876, 1.305831387622618, 1.3987267607621379, 1.0367100135016138, 1.460120140021981, 1.1748430688091815, 1.3482195799366425, 1.4472123109467083, 2.1392162029833806, 1.8993856930074693, 1.345631586645628, 1.9861226549386668, 1.5537019862210233, 0.7927379962116721, 1.7076404812158419, 1.4801883349582035, 1.9028253834270448, 0.9721071475911147, 0.9818712209804037, 1.837453352525844, 0.7923039782184382, 0.3954822493190413, 2.033998686690448, 1.5657747322458437, 1.0866199336574223, 1.2975189907813878, 0.5873802128067762, 0.9307708456611774, 0.13625199800639365, 0.7082595807672831, 1.0022920688120163, 0.76750275855062, 0.2662544599777128, 0.4098105654280282, 1.7888221068705512, 0.49111307966085427, 0.17999597500518938, -0.1474131071462903, -0.08404216666737518, 0.5334514862262374, 0.6050196719225198, 0.21774281345392055, 0.1032716052808702, 0.09148397309585832, 0.17749434075075676, -0.0986007078971074, -0.2918055689176491, -0.1039731633901475, -0.9002035033963907, -0.24847333237402403, -0.9276119549261352, -0.7435473004793636, 0.40434387645153613, -0.7393746534383627, -0.7976778296361875, -0.9152097317855556, -0.7791468079292319, -1.1592968955638039, -1.1904765862517674, -0.9353366679498709, -0.8379011145278703, -1.4158492147274426, -1.4329877304470573, -1.6409962507667064, -1.0324081453766532, -1.0841143645650053, -1.5204654996345601, -0.9279095653190961, -1.5522439781671649, -1.4707122718427668, -1.2794309291877148, -1.7908388533132458, -1.7195126857641396, -1.7507823855554916, -1.9428076233589353, -1.6436042017624808, -1.738665363617422, -1.8370759153608684, -2.044945167960006, -1.7817923087691723, -1.9735827689262442, -1.814274545037412, -2.0923151217939515, -1.823459328290517, -2.0873620078460764, -1.748353203933914, -2.1681907162244225, -2.191671453111409, -1.8795387051673011, -2.0548412725310192, -1.734423296018125, -2.521099690609363, -1.8069751480969543, -1.8624787830020817, -1.8432661618065849, -1.8811064142384049, -2.1769586509407146, -1.9728385456692132, -1.8368330305367664, -1.8888452999718375, -1.7235195008108395, -1.9417007638263817, -1.7508746380934825, -1.9052520311229237, -1.8533544979478034, -1.7230298472668126, -1.333510197003993, -1.824081190896143, -1.8065512308309106, -1.6983927401210241, -1.9090990877579994, -1.5147679044089468, -2.1829631699803365, -1.8190997613796878, -2.008965592342369, -1.660727498148864, -1.3184047496066498, -2.0132084228529123, -1.8855664343721035, -2.0566665181036825, -1.010200088024522, -1.9147782684555192, -1.708174173935726, -1.1656112869024238, -1.5899355421746364, -1.3231157528016446, -1.2949763424892158, -0.9553090220229343, -0.5049593886938286, -0.7962019106797502, -0.8409451168783022, -0.5414791936772101, -0.9170248744486642, 0.10947657229835706, -0.45998729629284973, -0.7331573372335054, -0.9557867903354644, -1.6710353609751571, 1.1408809398857755, -0.35218299217575577, 0.16873332688176035, -0.8100565870097753, -1.3129635894185654, -0.9410313564592521, -0.3655127417010817, 0.34516098406569995, 0.9509987686194599, 3.1474649107561348, 1.5764477800088539, 1.561407142631177, 0.5103592505843579, 0.6604137880366068, 0.8245554644470765, 0.4303975815485739, 0.5208191718048916, 0.9960861840983881, 0.8712939777994588, 0.6593188609400524, 1.211331692491262, 1.4464669394382312, 0.5158051146573328, 0.408478484345407, 1.0684516123474008, 1.5067615712035831, 1.0143536400791042, 1.6262243268786403, 1.7065649631965485, 1.8556542755884475, 1.5514212609868672, 1.7592292332039694, 1.3486238078514567, 1.4605846929291832, 2.0607866768926897, 2.02837872701787, 1.5117193369248039, 1.6802502700067645, 1.6504942711469273, 1.6374529938590143, 1.746877393000137, 2.3861786882994007, 1.7548901822816587, 2.530238376722913, 2.147983269135927, 1.869568847816927, 1.762869955059121, 2.2054720886729395, 1.9740977998644071, 1.6691321040597185, 5.199133840888388, 2.2710009896416716, 2.3992855461660345, 1.9515767268630557] ,'y': [-0.028146761264425918, 0.11280241441386639, 0.021093729364998204, 0.0765911300325631, -0.30157127655658694, -0.08193787111092028, -0.3167337335211912, -0.5816794713884622, -0.16422612752908725, -0.5730649094717927, -0.9877135360433281, -0.06017135060507717, -0.4902752780768649, 0.0683378989631983, 0.02489740057162959, -0.04992213856938266, -0.08904590465503848, 0.8495741555305886, -1.3862622459766816, 0.29836549759479636, 0.2993115897338555, -0.22405535491779316, 0.06294017110048844, -0.37437140921342815, -0.25821327605917543, -0.38520694161633284, 0.04730248604170595, 0.4588311476856738, -0.4977821460063825, -0.449505140297341, -1.0036218554999414, -0.5704197608359585, -0.0469464251940932, -0.1623068209262235, -0.41150629023973817, -0.30366990136738825, -0.44294674230255127, 0.015510770715867483, -0.41152790965877983, 0.32155749366753694, -0.24927126522356735, -0.2819060260725026, -0.4978433973903762, 0.19847530602050356, -0.2552754246301725, 0.051763981117176616, -0.0024472042339429567, -0.16386153021931027, -0.7431482175759208, -0.30634721996687264, -0.5130316071951846, -0.052953546678011776, 0.3516525551058103, 0.22751907815591998, 0.9301512882893836, -0.4089086001690423, 0.9778613791720947, 1.4180336358148526, 0.2219926861672683, 1.1720637750767426, 1.0627133911354214, 1.1623084242928121, 0.7082297824001954, 0.7021799583303284, 1.097046533274208, 1.096322614756838, 1.0434163772271297, 0.28451225754707277, 0.7365732861067986, 1.7420387906463901, 0.7543977277611008, 0.8659572801987281, 1.0391680927448066, 1.3361392927981197, 1.6961595822919684, 1.7639814484116234, 1.4837096398189886, 1.47388738938792, 1.8112573514827224, 2.215909770188831, 1.0290830677258822, 1.5766555027613482, 1.4069190669320752, 1.9065695791240556, 2.1176548412201335, 1.4813917794249365, 2.1500030705176787, 2.311485821122856, 1.8877624647554692, 1.8676211075092786, 2.077755411376936, 1.8587687779505835, 2.1464257170560064, 2.553309757226776, 2.5388876849454345, 2.350613264831347, 2.306614020810356, 2.430027519528304, 2.2556204127426582, 2.4985068810420774, 2.287686273428866, 2.386834103628521, 2.0233584454280606, 2.058181377583441, 1.9975939179264213, 2.0010963050081454, 1.9165511152181747, 1.6546909012842281, 2.0421489329241105, 1.7137401229477778, 2.63736419816591, 2.6063493576854313, 1.9653545316418253, 1.8573451787964146, 2.2390152695933274, 1.9985207071807132, 1.4227271059785807, 2.3264656021958174, 1.816556829819369, 1.8512108212757283, 1.5685669397919355, 0.6899474215457424, 1.9903766703217762, 2.4898017465870304, 1.21356108666399, 3.052952365047794, 1.3207670837517504, 1.4363118241371886, 1.2792445497590421, 1.3681242872741706, 0.5322414651162077, 0.7964721115901519, 1.186010231032899, 0.8245734726390097, 0.6888315013074653, 1.112816302961921, 0.3790444059851694, 0.8874575364998982, 0.5818598160037958, 0.519365509134051, 0.8023671445767278, 0.4908033258367972, -0.02412829148889628, 0.5214410026317751, 0.4179620892598024, -0.4526110668317074, 0.32959307660416215, -0.12499636380550072, -0.25309073321110986, 0.5024855243451398, -0.3355468399012196, 0.06949081749821673, 0.05891922385094617, -0.4160641060917136, -0.6619230830786726, -0.33660588632031363, -0.5613213054189004, -0.4024302688234549, -0.581894470326727, -1.0682371215613884, -0.8151093298767442, -0.8380247283607467, -0.7754289491089494, -1.2236437865120742, -0.7797224480549936, -0.7100456296841173, -0.5905928040888142, -1.0353116997810297, -0.9607682258624273, -0.8387669688462474, -1.554990040863622, -1.1648778504655866, -1.341860202887375, -1.338277036038118, -1.089212577724048, -1.4925900400915815, -1.7054321863527022, -1.2118768964679028, -1.9253765944086432, -1.641955894306193, -1.8651959572354215, -1.9418970994966678, -1.721716849527546, -1.9900624203645911, -1.5114282697277837, -1.6780278251187042, -1.8536175877281913, -2.3823356813286267, -1.4673358453873675, -2.252208334068362, -2.007425701116814, -2.0059033776809354, -1.6985235861169823, -1.9611158078673885, -2.2381088321780407, -2.416826170023665, -2.2214710616736877, -2.5000237458253327, -2.4064062106766393, -1.8380167637321332, -2.51984823306028, -2.892606229682988, -2.7512259473521627, -2.3117008548885742, -1.719409727215977, 1.2241871361572176, -0.6003442566489081, -0.5931995305496329, -2.006684316720886, -1.9632240097055753, -1.9498205759937015, -2.12439967500889, -1.888079109217915, -2.0949242162803206, -1.75916636612798, -2.234747186365733, -1.6767841580354137, -1.756693468266013, -2.415372989827147, -2.087745495816611, -2.5631254769736955, -1.5154391697722147, -1.8461467614870353, -1.3604775672836178, -1.5938100716950077, -1.7658799476595788, -1.3019100028717667, -1.526565412437837, -0.6849219725544664, -0.9517153324152205, -1.5083617065456179, -2.066628827074556, -0.7862407415227812, -0.056314150765670035, -1.1164673731691248, -1.0647022911440944, -0.6949760130947252, -1.0460297061993629, -0.3261281583053195, -1.4843405206783207, -1.008176834222364, -0.01710995514418112, 1.0698627927726083, -0.8748655360153496, 0.4068961808982391, 0.05323700250707608, -6.8071691819464215, 0.38165019072974093, 0.09845364714037852, 0.5572419582848664] ,'theta': [0.0791760728366665, -0.046294184406074114, -0.011718644700553426, 0.132365732760924, 0.256033900916522, 0.10563615452855071, -0.032114215012222225, 0.1125171836358254, -0.06649175659699053, 0.10322517124500018, 0.2500861541496617, 0.09049466452373187, -0.06082532790332079, -0.22876931338658327, 0.31191572449541655, -0.20501528305576486, 0.24156620563148046, 0.012670201136903148, 0.25650093955695924, -0.5522404574862045, 0.18793492875327403, 0.09556037372876788, 0.11794644583434377, 0.09148523509751039, 0.0318776433372088, -0.09162475586798682, 0.04624934222337368, -0.016030744566809946, -0.037424307853841376, 0.029674081124628354, 0.17611353916156577, 0.07597543441732718, 0.01693135252804734, 0.07419115229276185, 0.027727305959553417, 0.06242001858836471, -0.04833920478731879, 0.09096029079059598, -0.01653791601240351, -0.10636286203444367, 0.0661482727411028, 0.008715955207596049, 0.015693342866297533, -0.08209996717368662, 0.02237209465416029, -0.08760815246684622, 0.2437971193157626, -0.11810842940981947, 0.058699836252947, -0.010496925944774582, -0.001208922752067576, 0.5610833243989327, 0.020659682564581616, 0.4300013336825967, 0.369215130589548, 0.46429996623868985, 0.1851664394999547, 0.16366435561729065, 0.33520971541421196, 0.1767716215227627, 0.18120875036304107, 0.12095596418877308, 0.24443669427243353, 0.27276560149259277, 0.3378698701126248, 0.17771877231756217, 0.4277875302551093, 0.3778264274968368, 0.23348433642715993, 0.5628747672487788, 0.2701668112941513, 0.3304476324595951, 0.31110585200367913, 0.5474722601633908, 0.20030929603534697, 0.3463917984911902, 0.3244616506702802, 0.14188596193210556, 0.22356972759024263, 0.3242856860613408, 0.1902648390546191, 0.3281115985214367, 0.23986793030933873, 0.054997304811938985, 0.37674895509122175, 0.21604660481783222, 0.5643271535197902, 0.33781454749927553, 0.3161761985461231, 0.17696061343044578, 0.2752886764800966, 0.35768497171152047, 0.3371961005139057, 0.34931424324451843, 0.3208403911459645, 0.3147729495336371, 0.3114940128213295, 0.2466114221233795, 0.30988087713452517, 0.2778248104229797, 0.29065140321388405, 0.3549437503144359, 0.31482566738634477, 0.36085140098269575, 0.28007505710693437, 0.34758731834853007, 0.2377036553847689, 0.38830599729311466, 0.2231900981953161, 0.28069755711981337, 0.46175482926399614, 0.2834657872500701, 0.3165981364094339, 0.27470785635774764, 0.32099792741555166, 0.301578344032718, 0.3054922122937942, 0.31173354299751654, 0.3655017810502903, 0.31560792327625986, 0.2869483409501816, 0.2106598728341602, 0.3230386875342539, 0.4323657295706429, 0.293599382398666, 0.5049864029657103, 0.31411643291392455, 0.35010983864079304, 0.3424796928254814, 0.33959297734951654, 0.2255824241431137, 0.2674864845101066, 0.30261830369731957, 0.2971072028682764, 0.2771314942871195, 0.3319851670064944, 0.23882100333251444, 0.3491327798990662, 0.2802315768990171, 0.3154134499565986, 0.26637515806239964, 0.3563111182771461, 0.24915305796556098, 0.31446322326245113, 0.34474814387156716, 0.20339380524674766, 0.2956244542702713, 0.3173326488679207, 0.2302872679558865, 0.3868933492749882, 0.20630762972619898, 0.3617661674438688, 0.3408996463344849, 0.3514524884307768, 0.16821164410867784, -49.764342626329885, -12.339234316261942, 0.35214945481263804, 0.20190357007074056, 0.40143978568387695, 0.3169296073514527, 0.19887695054369825, 0.33644225594939403, -0.015720116306616738, 0.23643702427766478, 0.32386277763433835, 0.3601875891157835, 0.30464539402963897, 0.2403990284720292, 0.106369591417943, 0.011766616859469892, 0.22324283287783686, 0.3964609626092974, 0.5557693464293489, 0.1275562269274566, 0.26512983828974157, 0.6902745728093151, 0.4305347613777011, 0.305951875542152, 0.41994451693834645, 0.3491355958845821, 0.3509080465108161, 0.36381460259762743, 0.2374120592588147, 0.32563794904217236, 0.31981982586056557, 0.31365212024647704, 0.24454703589460447, 0.3499059977887997, 0.30866708735580284, 0.4052960165400399, 0.1813724046221643, 0.28302718412882344, 0.3311888149121178, 0.22517467188072127, 0.32761764909259083, 0.44873563524040483, 0.2928189865025055, 0.32904152971423795, 0.1856970708114125, 0.1073666269760798, 0.29458724825913274, 0.19661356840674715, 0.4180299583228786, 0.3785436227267991, 0.657336360028622, 0.5008850485647343, 0.394468983526739, 0.35534827017299486, 0.3048000217669067, 0.3040196727047739, 0.2759505701227738, 0.35282993987362676, 0.4195366310635129, 0.3509982227462727, 0.1825783846320106, 0.314679511754854, 0.5445776237472344, 0.01728774215340234, 0.042687115855228885, 0.39918960397493763, 0.40122981741512853, 0.24830558167113326, 0.4678901308177441, 0.319164390665696, 0.38348029094167346, 0.3144839241741615, 0.4420535440809126, 0.251027673730565, 0.10714913753384847, 0.4229028750481756, 0.18160673369647107, 0.3361619819684669, 0.409055008851531, 0.17483571051003233, 0.5522593592124908, 0.23207468328650616, 0.487230618205442, 0.28021916409481984, 0.2507827449713429, 0.423260577820303, 0.41616314863290454, 0.48677010719626407, 0.0745522911660898, 0.4196759533798781, 0.33742429511762384, -0.07318870492195886, 0.2882986900208683, 0.38814283926386367, 0.3678591346868329] }
fs2_out={'x': [0.017797827510222346, 0.011639261463635643, 0.03174838392943612, 0.02895202078623695, 0.023917293205943196, 0.033004117869690514, -0.02055204885084548, -0.0016068713472996397, 0.003585488946294846, -0.033619101201181834, -0.1306572341012158, -0.143787511028686, -0.1615282137173729, -0.17411977983458735, -0.25739151177273695, -0.234459875956249, -0.20645219011540938, -0.27116935035320167, -0.024741871715068035, -0.13443420584626437, -0.2501312187548772, -0.34358539751473066, -0.3580091562350975, -0.37592115797248415, -0.400939794211791, -0.4546459599475579, -0.45654346638681764, -0.4511837018176623, -0.510056341778315, -0.5157051162029461, -0.5536810096894301, -0.5618354790688026, -0.5724929443359273, -0.5732760061054396, -0.5824217360610628, -0.599776555842871, -0.5909282045440739, -0.6084956583940072, -0.6239133411671338, -0.6280496220900831, -0.6393069083387976, -0.6462910183472651, -0.6340910502825082, -0.6164377339974032, -0.5968704504439629, -0.5878149331100677, -0.6128140792307376, -0.6031081589160926, -0.6189543968370891, -0.6462860555595605, -0.6335497806160842, -0.43645618418865234, -0.2255710679274273, -0.02261613626614611, 0.10886425655450035, 0.2624374777194379, 0.4435647339653219, 0.580958955632362, 0.7099602920662808, 0.8405434308285425, 0.9804161069047563, 1.0840871082549177, 1.2300991222571158, 1.347583429138034, 1.4824053871316982, 1.627126618226369, 1.8410482385247071, 2.030986807825454, 2.165549966490017, 2.3641622319838835, 2.519532430605986, 2.598806230227153, 2.7695702783487373, 2.9175891118445576, 3.107871650187262, 3.2050823649463736, 3.303269487044414, 3.4870148222969983, 3.566245220118842, 3.6057934450507463, 3.809193313719791, 3.9657707869443755, 4.074432780310118, 4.2041846793882565, 4.262922700668934, 4.355999785235052, 4.369624985035691, 4.4404509431124195, 4.540680149993621, 4.617430425848683, 4.644055871846454, 4.685036928389257, 4.863919139076312, 4.913030447042398, 4.931030044542917, 4.916288733828288, 4.90788451716155, 4.961229665784174, 5.021731632976426, 5.043505914321818, 5.053833074849905, 5.062981472159491, 5.0807309062345665, 5.070870835444856, 5.041690278553091, 5.031292962214076, 4.941272611874437, 4.916425278637035, 4.823664083144421, 4.749309353096485, 4.789743740741638, 4.715806275397802, 4.636038492434183, 4.544517519255628, 4.466602838462705, 4.350673148906324, 4.231625490281147, 4.13809182348616, 4.054301712033373, 3.912716790560629, 3.7694180175159233, 3.6053183924392527, 3.5020775779015874, 3.393666141445087, 3.241619591481631, 3.148828634949721, 2.9936042371330047, 2.846533009948728, 2.7185899170299566, 2.539506031698632, 2.367554763122218, 2.192476524566669, 1.9981957622307753, 1.8338353420545273, 1.659968805692785, 1.4762612141566982, 1.2717666973606976, 1.0935874664837804, 0.8962291895911559, 0.7148017350874147, 0.5055702229080196, 0.32322429007896786, 0.11448808929436022, -0.0603472310990312, -0.27716630272147347, -0.4963334480326144, -0.6842873185493445, -0.8897714458024465, -1.063213775404259, -1.3153237444651953, -1.4960212592748907, -1.6822691375750989, -1.8665957537557574, -2.054706395179598, -2.2724022602736693, -2.4696861148405906, -2.6533694178942673, -2.842253947891451, -3.014605897972535, -3.208775974355173, -3.3838634381645214, -3.5743886412768138, -3.759724091071594, -3.9320270757982754, -4.065378095498675, -4.247786214588289, -4.42844133767138, -4.5982806116834825, -4.789190520459282, -4.940667310900177, -5.158963627898211, -5.3408736040361795, -5.541770163270416, -5.707842913085303, -5.839683388045968, -6.041004230331259, -6.229560873768469, -6.435227525578838, -6.53624753438129, -6.727725361226842, -6.898542778620414, -7.015103907310657, -7.17409746152812, -7.306409036808285, -7.435906671057206, -7.5314375732595, -7.581933512128883, -7.661553703196858, -7.745648214884688, -7.799796134252409, -7.891498621697275, -7.88055096446744, -7.926549694096725, -7.999865427820075, -8.095444106853622, -8.262547642951137, -8.14845954896256, -8.183677848180135, -8.16680451549196, -8.247810174192937, -8.379106533134793, -8.473209668780719, -8.509760942950827, -8.475244844544257, -8.38014496768231, -8.065398476606697, -7.907753698605812, -7.751612984342694, -7.700577059284258, -7.634535680480598, -7.55208013403589, -7.509040375881033, -7.4569584587005435, -7.357349840290705, -7.270220442510759, -7.204288556416754, -7.083155387167627, -6.938508693223804, -6.886928181758071, -6.84608033332353, -6.73923517208879, -6.588559014968432, -6.4871236509605215, -6.324501218272657, -6.153844721953003, -5.968279294394158, -5.813137168295471, -5.637214244975074, -5.5023518641899285, -5.35629339489701, -5.150214727207741, -4.947376854505954, -4.796204920813474, -4.628179893812797, -4.463130466698105, -4.299385167312203, -4.1246974280121895, -3.8860795591822495, -3.7105905409540836, -3.4575667032817923, -3.2427683763681996, -3.055811491586507, -2.879524496080595, -2.658977287213301, -2.46156750722686, -2.2946542968208883, -1.7747409127320495, -1.5476408137678823, -1.3077122591512789, -1.1125545864649733] ,'y': [-0.002814676126442592, 0.008465565314944048, 0.010574938251443868, 0.01823405125470018, -0.011923076400958518, -0.020116863512050547, -0.05179023686416967, -0.1099581840030159, -0.12638079675592462, -0.18368728770310389, -0.2824586413074367, -0.2884757763679444, -0.3375033041756309, -0.33066951427931107, -0.3281797742221481, -0.3331719880790864, -0.3420765785445902, -0.25711916299153137, -0.3957453875891995, -0.3659088378297199, -0.33597767885633434, -0.35838321434811365, -0.3520891972380648, -0.3895263381594076, -0.41534766576532517, -0.45386835992695845, -0.44913811132278786, -0.4032549965542205, -0.45303321115485873, -0.49798372518459283, -0.598345910734587, -0.6553878868181828, -0.6600825293375921, -0.6763132114302145, -0.7174638404541883, -0.7478308305909271, -0.7921255048211823, -0.7905744277495955, -0.8317272187154735, -0.7995714693487198, -0.8244985958710765, -0.8526891984783268, -0.9024735382173644, -0.8826260076153141, -0.9081535500783313, -0.9029771519666137, -0.903221872390008, -0.919608025411939, -0.993922847169531, -1.0245575691662183, -1.0758607298857368, -1.081156084553538, -1.045990829042957, -1.023238921227365, -0.9302237923984266, -0.9711146524153308, -0.8733285144981213, -0.7315251509166361, -0.7093258822999092, -0.592119504792235, -0.4858481656786928, -0.3696173232494116, -0.29879434500939206, -0.22857634917635922, -0.11887169584893839, -0.00923943437325458, 0.09510220334945839, 0.12355342910416567, 0.19721075771484553, 0.37141463677948455, 0.44685440955559463, 0.5334501375754674, 0.6373669468499481, 0.7709808761297601, 0.9405968343589569, 1.1169949792001193, 1.2653659431820181, 1.4127546821208101, 1.5938804172690824, 1.8154713942879654, 1.9183797010605537, 2.0760452513366885, 2.216737158029896, 2.4073941159423016, 2.619159600064315, 2.7672987780068086, 2.9822990850585764, 3.213447667170862, 3.402223913646409, 3.588986024397337, 3.7967615655350304, 3.9826384433300888, 4.197281015035689, 4.452611990758367, 4.7065007592529104, 4.941562085736045, 5.172223487817081, 5.415226239769911, 5.640788281044177, 5.890638969148385, 6.119407596491271, 6.358091006854123, 6.5604268513969295, 6.766244989155274, 6.966004380947916, 7.16611401144873, 7.357769122970548, 7.523238213098971, 7.727453106391382, 7.898827118686159, 8.16256353850275, 8.423198474271294, 8.619733927435476, 8.805468445315118, 9.02936997227445, 9.229222042992522, 9.37149475359038, 9.604141313809961, 9.785796996791898, 9.970918078919471, 10.127774772898665, 10.196769515053239, 10.395807182085417, 10.64478735674412, 10.766143465410519, 11.071438701915298, 11.203515410290473, 11.347146592704192, 11.475071047680096, 11.611883476407513, 11.665107622919134, 11.74475483407815, 11.863355857181439, 11.94581320444534, 12.014696354576087, 12.125977984872279, 12.163882425470796, 12.252628179120785, 12.310814160721165, 12.36275071163457, 12.442987426092243, 12.492067758675923, 12.489654929527033, 12.54179902979021, 12.58359523871619, 12.53833413203302, 12.571293439693436, 12.558793803312886, 12.533484729991775, 12.583733282426289, 12.550178598436167, 12.557127680185989, 12.563019602571083, 12.521413191961912, 12.455220883654045, 12.421560295022013, 12.365428164480123, 12.325185137597778, 12.266995690565105, 12.160171978408966, 12.078661045421292, 11.994858572585217, 11.917315677674322, 11.794951299023115, 11.716979054217616, 11.645974491249204, 11.586915210840322, 11.48338404086222, 11.387307218275977, 11.303430521391352, 11.14793151730499, 11.031443732258431, 10.897257711969694, 10.763430008365882, 10.654508750593477, 10.505249746584319, 10.334706527949049, 10.213518838302258, 10.020981178861394, 9.856785589430775, 9.670265993707233, 9.476076283757566, 9.303904598804811, 9.104898356768352, 8.953755529795574, 8.785952747283703, 8.600590988510884, 8.362357420378022, 8.215623835839285, 7.990403002432449, 7.789660432320767, 7.589070094552674, 7.4192177359409754, 7.223106155154237, 6.9992952719364325, 6.757612654934066, 6.535465548766697, 6.285463174184164, 6.0448225531165, 5.861020876743287, 5.609036053437259, 5.31977543046896, 5.044652835733744, 4.813482750244886, 4.641541777523289, 4.76396049113901, 4.7039260654741195, 4.644606112419156, 4.443937680747068, 4.24761527977651, 4.05263322217714, 3.840193254676251, 3.6513853437544594, 3.4418929221264274, 3.2659762855136294, 3.042501566877056, 2.8748231510735147, 2.6991538042469134, 2.4576165052641987, 2.2488419556825376, 1.992529407985168, 1.8409854910079466, 1.656370814859243, 1.5203230581308813, 1.3609420509613805, 1.1843540561954227, 1.054163055908246, 0.9015065146644623, 0.8330143174090157, 0.7378427841674936, 0.5870066135129318, 0.3803437308054762, 0.30171965665319805, 0.29608824157663105, 0.18444150425971856, 0.0779712751453091, 0.008473673835836578, -0.09612929678409972, -0.12874211261463167, -0.27717616468246375, -0.37799384810470016, -0.37970484361911827, -0.27271856434185743, -0.3602051179433924, -0.3195154998535685, -0.31419179960286087, -0.9949087177975031, -0.956743698724529, -0.9468983340104912, -0.8911741381820045] ,'theta': [0.007917607283666651, 0.0032881888430592392, 0.0021163243730038966, 0.015352897649096298, 0.0409562877407485, 0.05151990319360357, 0.04830848169238135, 0.05956020005596389, 0.052911024396264834, 0.06323354152076485, 0.08824215693573102, 0.09729162338810421, 0.09120909059777213, 0.0683321592591138, 0.09952373170865546, 0.07902220340307897, 0.10317882396622702, 0.10444584407991733, 0.13009593803561326, 0.0748718922869928, 0.0936653851623202, 0.10322142253519699, 0.11501606711863137, 0.1241645906283824, 0.1273523549621033, 0.1181898793753046, 0.12281481359764197, 0.12121173914096098, 0.11746930835557684, 0.12043671646803968, 0.13804807038419625, 0.14564561382592897, 0.1473387490787337, 0.1547578643080099, 0.15753059490396523, 0.1637725967628017, 0.15893867628406982, 0.16803470536312942, 0.16638091376188907, 0.1557446275584447, 0.16235945483255498, 0.1632310503533146, 0.16480038463994434, 0.15659038792257568, 0.1588275973879917, 0.1500667821413071, 0.17444649407288335, 0.1626356511319014, 0.1685056347571961, 0.16745594216271864, 0.16733504988751188, 0.22344338232740515, 0.22550935058386332, 0.268509483952123, 0.3054309970110778, 0.3518609936349468, 0.37037763758494224, 0.3867440731466713, 0.4202650446880925, 0.4379422068403688, 0.4560630818766729, 0.4681586782955502, 0.49260234772279354, 0.5198789078720528, 0.5536658948833153, 0.5714377721150715, 0.6142165251405824, 0.6519991678902661, 0.6753476015329821, 0.73163507825786, 0.7586517593872751, 0.7916965226332346, 0.8228071078336026, 0.8775543338499416, 0.8975852634534763, 0.9322244433025954, 0.9646706083696234, 0.9788592045628339, 1.0012161773218582, 1.0336447459279923, 1.0526712298334542, 1.0854823896855978, 1.1094691827165317, 1.1149689131977256, 1.1526438087068478, 1.174248469188631, 1.23068118454061, 1.2644626392905376, 1.29608025914515, 1.3137763204881945, 1.3413051881362041, 1.3770736853073562, 1.4107932953587468, 1.4457247196831986, 1.477808758797795, 1.5092860537511588, 1.5404354550332917, 1.5650965972456297, 1.5960846849590822, 1.6238671660013801, 1.6529323063227686, 1.6884266813542121, 1.7199092480928466, 1.7559943881911162, 1.7840018939018096, 1.8187606257366626, 1.8425309912751395, 1.881361591004451, 1.9036806008239826, 1.931750356535964, 1.9779258394623636, 2.0062724181873706, 2.037932231828314, 2.0654030174640887, 2.097502810205644, 2.1276606446089157, 2.158209865838295, 2.1893832201380468, 2.225933398243076, 2.2574941905707018, 2.28618902466572, 2.307255011949136, 2.3395588807025613, 2.3827954536596256, 2.4121553918994922, 2.4626540321960633, 2.4940656754874557, 2.529076659351535, 2.563324628634083, 2.597283926369035, 2.619842168783346, 2.646590817234357, 2.676852647604089, 2.7065633678909164, 2.7342765173196284, 2.767475034020278, 2.7913571343535293, 2.826270412343436, 2.8542935700333376, 2.8858349150289975, 2.9124724308352374, 2.948103542662952, 2.973018848459508, 3.0044651707857533, 3.03893998517291, 3.0592793656975847, 3.088841811124612, 3.120575076011404, 3.1436038028069926, 3.1822931377344914, 3.2029239007071113, 3.239100517451498, 3.2731904820849467, 3.3083357309280244, 3.325156895338892, -1.651277367294096, -2.88520079892029, -2.8499858534390263, -2.8297954964319523, -2.7896515178635646, -2.7579585571284193, -2.7380708620740495, -2.70442663647911, -2.7059986481097718, -2.6823549456820053, -2.6499686679185714, -2.613949909006993, -2.583485369604029, -2.5594454667568263, -2.548808507615032, -2.547631845929085, -2.5253075626413013, -2.4856614663803716, -2.4300845317374367, -2.417328909044691, -2.390815925215717, -2.3217884679347853, -2.278734991797015, -2.2481398042428, -2.2061453525489654, -2.171231792960507, -2.1361409883094256, -2.099759528049663, -2.0760183221237813, -2.043454527219564, -2.0114725446335076, -1.9801073326088598, -1.9556526290193994, -1.9206620292405194, -1.8897953205049391, -1.8492657188509352, -1.8311284783887187, -1.8028257599758364, -1.7697068784846246, -1.7471894112965525, -1.7144276463872934, -1.669554082863253, -1.6402721842130024, -1.6073680312415786, -1.5887983241604373, -1.5780616614628293, -1.548602936636916, -1.5289415797962413, -1.4871385839639535, -1.4492842216912736, -1.3835505856884114, -1.333462080831938, -1.294015182479264, -1.2584803554619646, -1.228000353285274, -1.1975983860147965, -1.1700033290025191, -1.1347203350151565, -1.0927666719088052, -1.057666849634178, -1.0394090111709768, -1.0079410599954914, -0.953483297620768, -0.9517545234054278, -0.9474858118199049, -0.9075668514224111, -0.8674438696808983, -0.8426133115137849, -0.7958242984320105, -0.7639078593654409, -0.7255598302712736, -0.6941114378538574, -0.6499060834457662, -0.6248033160727097, -0.6140884023193248, -0.5717981148145073, -0.5536374414448602, -0.5200212432480135, -0.47911574236286036, -0.46163217131185713, -0.40640623539060805, -0.38319876706195743, -0.33447570524141323, -0.30645378883193125, -0.28137551433479696, -0.23904945655276666, -0.1974331416894762, -0.1487561309698498, -0.14130090185324082, -0.099333306515253, -0.06559087700349062, -0.0729097474956865, -0.04407987849359967, -0.005265594567213305, 0.03152031890146999] }
print("yes, the Theta data jumps from pi to -pi, that's part of the intentional design of fastslam.. it does mean the derivative data jumps though")

sm = StreamMathsClass(lpf_avg_length=3, lpf_smoothing=3)
avg = {'x':[], 'y':[], 'theta':[]}
smooth = {'x':[], 'y':[], 'theta':[]}

# LPF signals 
for var in ['x', 'y', 'theta']:
    for i in range(len(ddt['x'])):

        avg[var].append(sm.lpf_moving_avg(ddt[var][i]))
        smooth[var].append(sm.lpf_smooth(ddt[var][i]))

# plotting logic
fig, axs = plt.subplots(3,2,sharex='col')

for i, var in [ [0, 'x'], [1, 'y'], [2, 'theta']]:

    axs[i][1].plot(fs2_out[var], label=var)
    axs[i][0].plot(ddt[var], label="numerical diff")
    axs[i][0].plot(avg[var], label="moving avg")
    axs[i][0].plot(smooth[var], label="smooth")
    axs[i][0].legend(loc="lower right")



# axis labels
from matplotlib.transforms import offset_copy
plt.setp([axs[2][0], axs[2][1]], xlabel='time (secs * 10)')
for ax in axs.flat:
    ax.grid()
    
# y ax labels
axs[0][1].set_ylabel('dist (m)')
axs[0][0].set_ylabel('velocity (m/s)')
axs[1][1].set_ylabel('dist (m)')
axs[1][0].set_ylabel('velocity (m/s)')
axs[2][1].set_ylabel('bearing (rad)')
axs[2][0].set_ylabel('angular velocity (rad/s)')

# column headings
for ax, col in zip(axs[0], ['derivative', 'signal']):
    ax.set_title(col)

# row titles
pad = 0
for ax, row in zip(axs[:,0], ['x', 'y', 'theta']):
    ax.annotate(row + '-axis', xy=(0, 0.5), xytext=(-ax.yaxis.labelpad - pad, 0),
                xycoords=ax.yaxis.label, textcoords='offset points',
                size='large', ha='right', va='center')
fig.tight_layout()
fig.subplots_adjust(left=0.15, top=0.95)

plt.show()

# plt.plot(fs2_out['x'], fs2_out['y'])
# plt.gca().set_aspect("equal")
# plt.show()
